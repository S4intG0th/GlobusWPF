<Window x:Class="GlobusWPF.AplicationsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:converters="clr-namespace:GlobusWPF.Converters"
        Title="Управление заявками" Height="500" Width="800">

    <!-- ДОБАВЛЯЕМ РЕСУРСЫ ОКНА -->
    <Window.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    </Window.Resources>

    <DockPanel Margin="10">
        <!-- Панель поиска и фильтрации -->
        <StackPanel DockPanel.Dock="Top" Margin="0,0,0,10">
            <TextBlock Text="Поиск:" Margin="0,0,0,5"/>
            <TextBox x:Name="txtSearch" Height="25" TextChanged="txtSearch_TextChanged"/>

            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                <TextBlock Text="Статус:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <ComboBox x:Name="cbStatusFilter" Width="150" SelectionChanged="cbStatusFilter_SelectionChanged">
                    <ComboBoxItem Content="Все" IsSelected="True"/>
                    <ComboBoxItem Content="Новые"/>
                    <ComboBoxItem Content="Подтвержденные"/>
                    <ComboBoxItem Content="Отмененные"/>
                    <ComboBoxItem Content="В обработке"/>
                </ComboBox>

                <TextBlock Text="Сортировка:" VerticalAlignment="Center" Margin="20,0,10,0"/>
                <ComboBox x:Name="cbSortBy" Width="120" SelectionChanged="cbSortBy_SelectionChanged">
                    <ComboBoxItem Content="Дате" Tag="Date" IsSelected="True"/>
                    <ComboBoxItem Content="Статусу" Tag="Status"/>
                    <ComboBoxItem Content="Стоимости" Tag="Price"/>
                    <ComboBoxItem Content="Клиенту" Tag="Client"/>
                </ComboBox>

                <Button x:Name="btnNewAplication" Content="Новая заявка" 
                       Margin="20,0,0,0" Width="100" Click="btnNewAplication_Click"/>
                <Button x:Name="btnRefresh" Content="Обновить" 
                       Margin="10,0,0,0" Width="80" Click="btnRefresh_Click"/>
            </StackPanel>
        </StackPanel>

        <!-- Список заявок -->
        <ListView x:Name="lvAplications" MouseDoubleClick="lvAplications_MouseDoubleClick">
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="№" 
                                  DisplayMemberBinding="{Binding AplicationId}" 
                                  Width="50"/>
                    <!-- В GridView в ListView добавьте новую колонку -->
                    <GridViewColumn Header="Клиент" 
                DisplayMemberBinding="{Binding ClientName}" 
                Width="150"/>
                    <GridViewColumn Header="Тур" 
                                  DisplayMemberBinding="{Binding TourName}" 
                                  Width="200"/>
                    <GridViewColumn Header="Дата брони" 
                                  DisplayMemberBinding="{Binding AplicationDate, StringFormat=dd.MM.yyyy}" 
                                  Width="100"/>
                    <GridViewColumn Header="Статус" 
                                  DisplayMemberBinding="{Binding Status}" 
                                  Width="100"/>
                    <GridViewColumn Header="Кол-во" 
                                  DisplayMemberBinding="{Binding PeopleCount}" 
                                  Width="60"/>
                    <GridViewColumn Header="Стоимость" 
                                  DisplayMemberBinding="{Binding TotalPrice, StringFormat=N0}" 
                                  Width="100"/>

                    <GridViewColumn Header="Действия" Width="200">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <Button Content="Просмотр" Width="70" Margin="2"
                                           Tag="{Binding AplicationId}"
                                           Click="ViewAplication_Click"/>
                                    <Button Content="Подтвердить" Width="80" Margin="2"
                                           Tag="{Binding AplicationId}"
                                           Click="ConfirmAplication_Click"  
                                           Visibility="{Binding Status, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                    <Button Content="Удалить" Width="70" Margin="2"
                                           Tag="{Binding AplicationId}"
                                           Click="DeleteAplication_Click"
                                           Foreground="Red"/>
                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView>
    </DockPanel>
</Window>